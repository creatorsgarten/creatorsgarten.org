---
import Head from '$commons/head.astro'
import Breadcrumb from '$components/breadcrumb.astro'
import { Connections } from '$components/connections'
import UserCard from '$dashboard/userCard.astro'
import BaseLayout from '$layouts/base.astro'
import { Icon } from 'react-iconify-icon-wrapper'

const { user } = Astro.locals
if (!user) return Astro.redirect('/')
---

<Head title="Profile & Connections | Dashboard" />

<BaseLayout class="mx-auto mt-8 max-w-7xl space-y-6 *:px-6">
  <Breadcrumb
    parents={[{ title: 'Dashboard', href: '/dashboard' }]}
    title="Profile & Connections"
  />

  <div class="mx-auto max-w-2xl space-y-6">
    <div class="rounded-2xl border border-neutral-300 bg-white p-6">
      <h2 class="mb-4 text-lg font-medium">My Profile</h2>
      <UserCard user={user} />

      <div class="mt-6 border-t pt-6">
        <h2 class="mb-4 text-lg font-medium">Profile Information</h2>
        <div class="grid gap-4">
          <div>
            <p class="text-sm text-neutral-600">Name</p>
            <p>{user.name}</p>
          </div>
          <div>
            <p class="text-sm text-neutral-600">Email</p>
            <p>{user.email}</p>
          </div>
          <div>
            <p class="text-sm text-neutral-600">User ID</p>
            <p class="font-mono text-sm">{user.sub}</p>
          </div>
        </div>

        <div class="mt-6 rounded-md border border-blue-200 bg-blue-50 p-4">
          <div class="flex gap-2">
            <div class="flex-shrink-0 text-blue-500">
              <Icon icon="heroicons:information-circle" className="h-5 w-5" />
            </div>
            <div>
              <p class="text-sm text-blue-700">
                Your profile information is imported from Eventpop. To update
                your profile information:
              </p>
              <div class="mt-2">
                <a
                  href="https://www.eventpop.me/users/edit"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="inline-flex items-center rounded-md bg-blue-600 px-3 py-2 text-sm font-medium text-white hover:bg-blue-700"
                >
                  <Icon
                    icon="heroicons:pencil-square"
                    className="mr-1 h-4 w-4"
                  />
                  Update Profile on Eventpop
                </a>
              </div>
              <p class="mt-2 text-xs text-blue-600">
                After editing your profile, the changes will be reflected on
                your account the next time you sign in.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="rounded-2xl border border-neutral-300 bg-white p-6">
      <h2 class="mb-4 text-lg font-medium">Connections</h2>
      <p class="mb-6 text-neutral-700">
        Connect your accounts to access additional features and services. When
        you join a working group, these connections help group leads know which
        usernames to use when inviting you to repositories or services.
      </p>
      <Connections connections={user.connections} />
    </div>
  </div>
</BaseLayout>
